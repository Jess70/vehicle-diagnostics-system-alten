<div class="file-manager-container">
  <mat-card class="main-card">
    <mat-card-header>
      <mat-card-title class="card-title">Uploaded Files</mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <div *ngIf="isLoading$ | async" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p class="loading-text">Loading files...</p>
      </div>

      <div *ngIf="!(isLoading$ | async)" class="table-container">
        <table mat-table [dataSource]="dataSource" class="files-table">
          <ng-container matColumnDef="filename">
            <th mat-header-cell *matHeaderCellDef class="table-header">File Name</th>
            <td mat-cell *matCellDef="let file" class="file-cell">
              <div class="file-info">
                <div class="file-name">{{file.filename}}</div>
                <div class="file-size">{{formatFileSize(file.sizeBytes)}}</div>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef class="table-header">Status</th>
            <td mat-cell *matCellDef="let file" class="status-cell">
              <div class="status-container">
                <span class="status-badge" [class]="getStatusClass(file.status)">
                  {{file.status}}
                </span>
                <mat-progress-bar 
                  *ngIf="file.status === 'PROCESSING'"
                  [value]="getProcessingProgress(file)"
                  mode="determinate"
                  class="progress-bar">
                </mat-progress-bar>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="progress">
            <th mat-header-cell *matHeaderCellDef class="table-header">Progress</th>
            <td mat-cell *matCellDef="let file" class="progress-cell">
              <div *ngIf="file.status === 'PROCESSING'" class="progress-info">
                <div class="progress-percentage">{{getProcessingProgress(file)}}%</div>
                <div class="progress-details">
                  {{formatFileSize(file.lastProcessedOffset)}} / {{formatFileSize(file.sizeBytes)}}
                </div>
              </div>
              <div *ngIf="file.status === 'COMPLETED'" class="status-complete">
                Complete
              </div>
              <div *ngIf="file.status === 'PENDING'" class="status-pending">
                Queued
              </div>
              <div *ngIf="file.status === 'FAILED'" class="status-failed">
                Failed
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef class="table-header">Uploaded</th>
            <td mat-cell *matCellDef="let file" class="date-cell">
              {{formatDate(file.createdAt)}}
            </td>
          </ng-container>

          <ng-container matColumnDef="updatedAt">
            <th mat-header-cell *matHeaderCellDef class="table-header">Last Updated</th>
            <td mat-cell *matCellDef="let file" class="date-cell">
              {{formatDate(file.updatedAt)}}
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="table-header">Actions</th>
            <td mat-cell *matCellDef="let file" class="actions-cell">
              <button mat-button [matMenuTriggerFor]="actionMenu" class="action-button">
                Actions
              </button>
              <mat-menu #actionMenu="matMenu" class="action-menu">
                <button mat-menu-item (click)="deleteFile(file)" class="menu-item delete-item">
                  Delete
                </button>
              </mat-menu>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>
        </table>

        <div *ngIf="dataSource.data.length === 0" class="empty-state">
          <h3 class="empty-title">No files uploaded</h3>
          <p class="empty-description">Upload some diagnostic log files to get started.</p>
        </div>
      </div>
    </mat-card-content>
  </mat-card>


</div>
